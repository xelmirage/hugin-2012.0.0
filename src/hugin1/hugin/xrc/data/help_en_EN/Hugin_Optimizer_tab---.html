<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.14.0" />
		<meta name="keywords" content="Hugin Optimizer tab,Barrel distortion,Control points,EXIF,Field of View,Heads,Hugin,Hugin Camera and Lens tab,Hugin Control Points tab,Hugin Control Points table,Hugin Images tab" />
		
		
		
		
		
		
		<title>Hugin Optimizer tab - PanoTools.org Wiki</title>
		
		
		
		<!--[if lt IE 5.5000]><![endif]-->
		<!--[if IE 5.5000]><![endif]-->
		<!--[if IE 6]><![endif]-->
		<!--[if IE 7]><![endif]-->
		
		
		
		
		<!--[if lt IE 7]>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		

		
		<style media="screen" type="text/css" title="Screen style sheet"> @import url(manual.css); </style>
		
				
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Hugin_Optimizer_tab skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Hugin Optimizer tab</h1>
		<div id="bodyContent">
			
			
												<!-- start content -->
			<p><a href="Hugin.html" title="Hugin">hugin</a> uses a photo alignment scheme where it adjusts image orientation and lens settings of source photos
until the <a href="Control_points.html" title="Control points">control points</a> line-up, this process is called <i>optimisation</i> and the <b>hugin Optimizer tab</b> is where it is controlled.  You actually <i>create</i> individual <b>control points</b> in the <a href="Hugin_Control_Points_tab.html" title="Hugin Control Points tab">hugin Control Points tab</a>, and <i>manage</i> them in the <a href="Hugin_Images_tab.html" title="Hugin Images tab">hugin Images tab</a> and <a href="Hugin_Control_Points_table.html" title="Hugin Control Points table">hugin Control Points table</a>.
</p><p>So to align photos you need some control points, a general rule is that optimising more parameters requires more control points.
</p>
<a name="Quick_Optimizer" id="Quick_Optimizer"></a><h2> <span class="mw-headline"> Quick Optimizer </span></h2>
<p>Use the <b>Optimize</b> combo box to pick one of several pre-set optimisation schemes, then click the <b>Optimize now!</b> button to calculate the best available fit.  For a spherical panorama, which is where each image is taken from the same position, you should not optimise translation. For a linear panorama<a class="external" href="http://wiki.panotools.org/wiki/index.php?title=Linear_panorama&amp;action=edit&amp;redlink=1">[*]</a>, where you take pictures from different locations of the same flat surface, you must optimise translation.
</p><p>One valid technique is to try each optimisation scheme in turn, starting at the top, and skipping the ones with translation if you are making a spherical panorama, until you are satisfied with the results.
</p><p>The <b>Optimisation result</b> tells you how good the alignment is, large control point error distances indicate one of several things:
</p>
<ul><li> Some <b>control points</b> are in the wrong place, look at the list in the <a href="Hugin_Control_Points_table.html" title="Hugin Control Points table">hugin Control Points table</a> and identify points with large distances and check they are set properly.
</li><li> If points are set correctly, there may be <a href="Parallax.html" title="Parallax">parallax</a> errors caused by camera movement between shots.  If so it may be necessary to decide which objects in the scene are important to have aligned and delete unrelated control points in the <a href="Hugin_Control_Points_tab.html" title="Hugin Control Points tab">hugin Control Points tab</a>.
</li><li> Otherwise you may not be optimising enough parameters.  For example, the <a href="EXIF.html" title="EXIF">EXIF</a> data retrieved from a <a href="JPEG.html" title="JPEG">JPEG</a> file may not give a very accurate starting <a href="Field_of_View.html" title="Field of View">Field of View</a>, in this case you should optimise <b>view (v)</b>.
</li></ul>
<p><b>Use only control points between images selected in preview window.</b> allows you to work on just a few
of the images in the current project rather than all of them.  Use the buttons along the top of the
<a href="Hugin_Preview_window.html" title="Hugin Preview window">Hugin Preview window</a> to enable and disable source photos.  When optimising with the
<strong class="selflink">Hugin Optimizer tab</strong>, all the hidden images will be ignored.
</p><p>The following pre-set optimisation schemes are provided:
</p>
<a name="Positions_.28incremental.2C_starting_from_anchor.29" id="Positions_.28incremental.2C_starting_from_anchor.29"></a><h3> <span class="mw-headline"> Positions (incremental, starting from anchor) </span></h3>
<p>This is the simplest setting, and is probably sufficient for a lot of purposes.  Only the relative orientation of images are optimised, lens parameters are left untouched, this works best if either of the following is true:
</p>
<ul><li> The lens has minimal <a href="Barrel_distortion.html" title="Barrel distortion">barrel distortion</a> and the photo <a href="EXIF.html" title="EXIF">EXIF</a> information supplies an accurate <a href="Field_of_View.html" title="Field of View">Field of View</a>.
</li></ul>
<p>or
</p>
<ul><li> Lens calibration<a class="external" href="http://wiki.panotools.org/wiki/index.php?title=Lens_calibration&amp;action=edit&amp;redlink=1">[*]</a> has already been performed, saved to a file and loaded into the current project via the <a href="Hugin_Camera_and_Lens_tab.html" title="Hugin Camera and Lens tab">hugin Camera and Lens tab</a>.
</li></ul>
<p>Note that to align any pair of photos, there should be at least two pairs of <a href="Control_points.html" title="Control points">control points</a> connecting them.
</p>
<a name="Positions_.28y.2Cp.2Cr.29" id="Positions_.28y.2Cp.2Cr.29"></a><h3> <span class="mw-headline"> Positions (y,p,r) </span></h3>
<p>This is exactly the same as the <i>incremental</i> setting above except that the parameters are optimised at once, this may confuse the optimiser if the images are not already roughly in the right place.  Don't use this setting.
</p>
<a name="Positions_and_View_.28y.2Cp.2Cr.2Cv.29" id="Positions_and_View_.28y.2Cp.2Cr.2Cv.29"></a><h3> <span class="mw-headline"> Positions and View (y,p,r,v) </span></h3>
<p>This is the same as optimising <b>Positions</b> except that the lens <a href="Field_of_View.html" title="Field of View">Field of View</a> is optimised too - Use this if you don't trust the Field of View calculated from the photo's <a href="EXIF.html" title="EXIF">EXIF</a> data.
</p><p>Note that for this too work you need at least three well-spaced pairs of <a href="Control_points.html" title="Control points">control points</a> between any pair of photos.  With a  360 degree panorama it is usually beneficial to optimise the <b>Field of View</b>, even if you have already calibrated this beforehand.
</p>
<a name="Positions_and_Barrel_Distortion_.28y.2Cp.2Cr.2Cb.29" id="Positions_and_Barrel_Distortion_.28y.2Cp.2Cr.2Cb.29"></a><h3> <span class="mw-headline"> Positions and Barrel Distortion (y,p,r,b) </span></h3>
<p>This is the same as optimising <b>Positions</b> except that an attempt is made to discover the lens <a href="Barrel_distortion.html" title="Barrel distortion">barrel distortion</a> at the same time. Only the <b>b</b> parameter of the full <a href="Lens_correction_model.html" title="Lens correction model">lens correction model</a> is varied by this optimisation scheme, as this is a reasonable approximation of the distortion of a typical lens. You should trust the field of view if you use this.
</p><p>Again you need at least three well-placed pairs of <a href="Control_points.html" title="Control points">control points</a> between any pair of photos.
</p>
<a name="Positions.2C_View_and_Barrel_.28y.2Cp.2Cr.2Cv.2Cb.29" id="Positions.2C_View_and_Barrel_.28y.2Cp.2Cr.2Cv.2Cb.29"></a><h3> <span class="mw-headline"> Positions, View and Barrel (y,p,r,v,b) </span></h3>
<p>As the name suggests this optimises positions, <a href="Field_of_View.html" title="Field of View">Field of View</a> and <a href="Barrel_distortion.html" title="Barrel distortion">barrel distortion</a> all at once.
</p>
<a name="Everything_without_translation" id="Everything_without_translation"></a><h3> <span class="mw-headline"> Everything without translation </span></h3>
<p>This optimises image orientation and all geometric parameters in the full <a href="Lens_correction_model.html" title="Lens correction model">lens correction model</a>. It includes more lens distortion parameters. The x shift and y shift (d and e) parameters account for the centre of the projection not being in the centre of the image. This is quite common, and gets very bad if an image is the cropped corner of another image.
</p><p>You will need many control points, the more the better, and preferably a full spherical panorama (360 by 180 degrees) to get the best correction. You should also use a calibrated panoramic head<a class="external" href="http://wiki.panotools.org/Heads">[*]</a>. If the control points are bad (either there are not enough or some are in the wrong place), or your images were not taken around the <a href="No-parallax_point.html" title="No-parallax point">no-parallax point</a>, this could produce bizarre results.
</p><p>However, if you do this well, you will accurately perform lens calibration<a class="external" href="http://wiki.panotools.org/wiki/index.php?title=Lens_calibration&amp;action=edit&amp;redlink=1">[*]</a>. You can save and reuse this lens information on the <a href="Hugin_Camera_and_Lens_tab.html" title="Hugin Camera and Lens tab">Hugin Camera and Lens tab</a>.
</p>
<a name="Positions_and_Translations_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.29" id="Positions_and_Translations_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.29"></a><h3> <span class="mw-headline"> Positions and Translations (y,p,r,x,y,z) </span></h3>
<p>This will optimise image orientation and the translation you get when moving the camera for a linear panorama. This is great for stitching images of the same flat surface taken from different places, for example when you couldn't fit a painting or the front of a building into one picture. Again it isn't ideal if the lens information such as the field of view is wrong.
</p>
<a name="Positions.2C_Translation_and_View_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.2Cv.29" id="Positions.2C_Translation_and_View_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.2Cv.29"></a><h3> <span class="mw-headline"> Positions, Translation and View (y,p,r,x,y,z,v) </span></h3>
<p>This is similar to <b>Positions and Translations</b>, except you can use it when you don't trust the <a href="Field_of_View.html" title="Field of View">Field of View</a> from the <a href="EXIF.html" title="EXIF">EXIF</a> data.
</p>
<a name="Positions.2C_Translation_and_Barrel_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.2Cb.29" id="Positions.2C_Translation_and_Barrel_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.2Cb.29"></a><h3> <span class="mw-headline"> Positions, Translation and Barrel (y,p,r,x,y,z,b) </span></h3>
<p>This is the same as optimising <b>Positions</b> and <b>Translation</b> except that an attempt is made to discover the lens <a href="Barrel_distortion.html" title="Barrel distortion">barrel distortion</a> at the same time. Only the <b>b</b> parameter of the full <a href="Lens_correction_model.html" title="Lens correction model">lens correction model</a> is varied by this optimisation scheme, as this is a reasonable approximation of the distortion of a typical lens. You should trust the field of view if you use this.
</p>
<a name="Positions.2C_Translation.2C_View_and_Barrel_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.2Cb.2Cb.29" id="Positions.2C_Translation.2C_View_and_Barrel_.28y.2Cp.2Cr.2Cx.2Cy.2Cz.2Cb.2Cb.29"></a><h3> <span class="mw-headline"> Positions, Translation, View and Barrel (y,p,r,x,y,z,b,b) </span></h3>
<p>This is useful when you are optimising a linear panorama, don't trust the field of view, and want to correct barrel distortion.
</p>
<a name="The_Custom_parameters_below" id="The_Custom_parameters_below"></a><h3> <span class="mw-headline"> The Custom parameters below </span></h3>
<p>The pre-set optimisation options are useful for most situations, but often it is necessary to switch to <b>Custom parameters</b>.
</p><p>For example, when shooting hand-held panoramas, some of the position variation between shots can be resolved by using different <b>d</b> and <b>e</b> <b>Image Center Shift</b> parameters for each shot.  Select <b>The Custom parameters below</b> and pick the <b>d</b> and <b>e</b> parameters for optimisation.  Note that by default, lens settings are shared for all photos in the project, go to the <a href="Hugin_Camera_and_Lens_tab.html" title="Hugin Camera and Lens tab">hugin Camera and Lens tab</a> and <i>uncheck</i> the <b>link</b> box for any you want to have different values in each photo.
</p><p>Similarly, the translation parameters could be used to correct a wonky shot. However, they were meant for linear panoramas which expand to infinite distance at 180 degrees field of view, so you must make sure any images with non-zero translation (X, Y, or Z parameters) are in the middle of the panorama (y and p should all be around zero, and the field of view shouldn't be large enough to make them expand more than 180 degrees). This can be used to patch in the floor after you have removed the tripod that was obscuring it. You can take a shot of the floor where the tripod was at an angle (therefore you can avoid casting a shadow on the image in most cases). You can then optimise X,Y,Z on only this image. However, the floor must be flat for this to work, and this shot must be in the middle of the panorama. You can make down the middle by rotating the panorama on either of the previews.
</p>
<a name="Image_Orientation" id="Image_Orientation"></a><h4> <span class="mw-headline"> Image Orientation </span></h4>
<p>The <b>Image Orientation</b> section shows the photo number and <a href="Roll.html" title="Roll">roll</a>, <a href="Pitch.html" title="Pitch">pitch</a> and <a href="Yaw.html" title="Yaw">yaw</a> rotation/orientation values for all input photos (in parenthesis), and the X, Y, and Z translation parameters. The <i>check</i> mark indicates parameters that will be optimised. The translation parameters should all be 0 on a spherical panorama.
</p>
<a name="Lens_Parameters" id="Lens_Parameters"></a><h4> <span class="mw-headline"> Lens Parameters </span></h4>
<p>The <b>Lens Parameters</b> section shows the lens number and the <a href="Lens_correction_model.html" title="Lens correction model">lens correction model</a> parameters (in parenthesis) for each of the distinct lenses in the project.  Only parameters that are <b>linked</b> in the <a href="Hugin_Camera_and_Lens_tab.html" title="Hugin Camera and Lens tab">hugin Camera and Lens tab</a> are shown in parenthesis.
</p><p>Note that normally all the photos in a project have the same lens, so there is usually only one row here.
</p>
<a name="edit_script_before_optimizing" id="edit_script_before_optimizing"></a><h4> <span class="mw-headline"> edit script before optimizing </span></h4>
<p><a href="Hugin.html" title="Hugin">hugin</a> actually creates a <a href="PTOptimizer.html" title="PTOptimizer">PTOptimizer</a> script file which it passes to the panorama tools library for optimisation, select <b>edit script before optimizing</b> and you can tweak this file for each optimisation run.
</p><p>This is something you would only do in obscure cases such as:
</p>
<ul><li> Linking the positions of input photos.  For example photos in a multi-row panorama taken with tripod can all be assumed to have the same <a href="Roll.html" title="Roll">roll</a>, similarly photos in each row can be assumed to have the same <a href="Pitch.html" title="Pitch">pitch</a> - This will help when there are few details available for setting <a href="Control_points.html" title="Control points">control points</a>.
</li><li> Optimising the <b>g</b> or <b>t</b> shear parameters of the <a href="Lens_correction_model.html" title="Lens correction model">lens correction model</a> for scanned images is only possible by editing the script file.
</li></ul>




<div class="printfooter">
Retrieved from "<a href="Hugin_Optimizer_tab.html">http://wiki.panotools.org/Hugin_Optimizer_tab</a>"</div>
			</div></div></div></div></body></html>